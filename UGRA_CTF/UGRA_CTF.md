# **UGRA_CTF**
Link to [course](https://course.ugractf.ru)

## **Keys**

### **01. Стеганография**

**Задача А. Во все поля**

Нужно открыть изображение из таска с помощью `wxhexeditor`. Далее через поиск найти начало ключа `ugra_`. Обратить внимание, что ключ состоит из нескольких частей!
(`ugra_like_sage_but_it_is_white_b95cbe94e`)

**Задача B. Коды-кодики**

Нужно открыть изображение из таска с помощью `Stegsolve`. Далее листать срезы с помощью кнопки > внизу. Отсканировать найденный QR-код.
(`ugra_distant_places_are_distant_7eee394b7`)

**Задача C. Скрытый текст**

Нужно открыть pdf через графический редактор `ImageMagick` (можно попробовать другое ПО, либо в редакторе pdf поиграться с цветовом шрифта). В явновом виде будут видны части флага.
(`ugra_invisible_4beef2984`)

**Задача D. OOXML**

С помощью `binwalk` изучить содержимое скачанного docx и извлечь все содержимое (`-e`). Ключ находится в файле flag.txt.
(`ugra_docx_is_zip_26aa3745f6a3`)

**Задача E. Разрез**

Для начала стоит ознакомиться со [статьей](https://habr.com/ru/articles/130472/). Затем:
1. Используя `wxhexeditor` найти чанк IHDR и определить размеры изображения;
2. Попробовать изменить ранее найденные параметры и CRC часть, чтобы избежать ошибки подсчета контрольной суммы;
3. Повторно открыть "увеличенное" изображение и увидеть флаг.
(`ugra_wow_extra_size_42b457`)

### **02. Форензика**

**Задача А. Лучшие снимки**

Используя `photorec` восстановить данные их скачанного образа. Ключ находится в одном из файлов.
(`ugra_remember_your_backups_5fd3440e9ada`)

**Задача B. Лес густой**

Скачать и открыть логи. Через поиск найти ключ.
(`ugra_find_and_let_it_be_found_ae5c3de717d`)

**Задача C. Загрузка**

Открыть скачанный дамп с помощью `wireshark`. Меню File - Export Objects - HTTP. Ключ находится в картинке.
(`ugra_this_is_icon_96a7518c8a4357194f00732f265`)

**Задача D. Сетевая атака**

Открыть скачанный дамп с помощью `wireshark`. Меню File - Export Objects - HTTP, выгрузить все, пробежаться по страницам и собрать ключ.
(`ugra_pcap_with_trash_6e2cc2999b78cc7`)

**Задача E. Энтерпрайз I**

Скачать архив, используя `bunzip` распаковать архив memory_dump.gz.bz2. `zcat memory_dump.gz| fgrep -za ugra`.
(флаг вытащить не удалось, т.к. долго парсится архив)

### **03. Криптография**

**Задача А. Не Цезарь** 

Шифр Цезаря или ROT8
(`ugra_know_your_history_a6ee3b9de4`)

**Задача B. Золотая таска**

[CyberChef](https://gchq.github.io/CyberChef/). Перевести флаг `to base` с параметром 16, затем `to hex`.
(`ugra_wow_dec_is_the_flag_3177d95780`)

**Задача C. Вращайте барабан** 

`Excel`. Распределить все символы начиная с `u`. Далее шаг символов для флага, 1, 5, 6 ... 67.
Использовать следующие выражения для подсчета флага:
1. `=ЕСЛИ(D1+C2>64; D1+C2-64;D1+C2)`
2. `="A"&D1`
3. `=ДВССЫЛ(E1)`
4. `=СЦЕП(F1:F64)`
Все что будет после точки можно убрать, т.к. точка не является частью флага.
(`ugra_let_this_wheel_move_on_032c6c19cbf0`)

**Задача D. Одна беда хорошо…**

[CyberChef](https://gchq.github.io/CyberChef/). Перевести флаг `from hex`. Добавить `XOR Brute Force` с параметром crib - ugra_ и key length - 2.
(`ugra_prepare_for_trouble_f345fd1059`)

**Задача E. Ягнятник**

[WolframAlpha](https://www.wolframalpha.com/):
1. n,c,e - дано
2. `n = p * q (factorize n)`
3. `φ = (p-1)*(q-1)`
4. `d — это обратное к e по модулю φ (inverse e mod φ)`
5. `answer = c^d mod n`
6. Расшифровать ключ по аналогии с Задачей B.
(`ugra_rsa_dbf95`)


### **04. OSINT**

**Задача А. АгроКекСтрой**

Погуглить компанию, найти страничку ВК, ключ лежит в товарах.
(`ugra_agrokek_vk_found_65570415c9e21dd7b734`)

**Задача B. Только для персонала**

Через [urlscan.io](urlscan.io) найти ифнормацию о сабдомене. Залогиниться под admin (пароль можно восстановить). Скачать два файла, ключ находится в xls, пароль от него в doc.
(`ugra_found_black_crm_10d51fcb9cffbf9f`)

**Задача C. По следам ошибок**

В параграфе 4.4 обратить внимание на 2 действие, проверить сайт компании. Найти в директории /private файл conf, там лежит указатаель на /cert. Названия файлов внутри директории - ключ.
(`ugra_keep_your_secrets_close`)

**Задача D. Бенефактор Контрафакт**

Изучить метанаднные картинок на сайте, можно через [Online metadata](https://online-metadata.com/). Обратить внимание на ник автора. Через [Namechek](https://namechk.com/) найти страничку на LiveJournal. Найти флаг в постах.
(`ugra_semurg_the_blogging_foreman`)

**Задача E. След в истории**

Так как IRC чат не доступен. Нужно изучить на википедии вклад пользователя - 193.138.89.40 и в истории изменений и правок найти флаг.
(`ugra_and_more_interests_and_my_beloved_63d7ddfbecc8`)


### **05. Веб-технологии**

**Задача А. Безопасный банк**

Через консоль разработчика найти куки на сайте и ипопробовать поменять их значение.
(`ugra_i_have_many_dollars_45673a5db6e0`)

**Задача B. Точечный удар**
https://dotted.board.course.ugractf.ru/57666eb99dbbca9b/files.php?page=../../../../etc/passwd
(`ugra_dot_dot_is_win_9ed3ca85a76c`)
